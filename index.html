<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <link rel="stylesheet" type="text/css" href="normalize.css"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vite App</title>

  </head>

  <body class="min-h-screen">    

    <style>
      .extender{
        min-width: 100%;
      }
      .up{
        transform: translateY(50%);
      }
      .upAll{
        transform: translateY(0);
      }
      .blue{
        background-color:#000000;
      }
      .text{
        opacity: 1;
        bottom: calc(80% - 300px);
      }

      .text2{
        opacity: 1;
        left: 25%
      }

      .text3{
        opacity: 0;
        left: 50%;
        bottom: calc(100% + 300px);
      }

    </style>

    <script src="/ScrollMagic.min.js"></script>
    <script src="/debug.addIndicators.min.js"></script>
    <script src="/TweenMax.min.js"></script>
    <script src="/animation.gsap.min.js"></script>
    <!-- <script src="https://cdn.tailwindcss.com"></script> -->
    <div class="min-h-[200px]"></div>
    <div id="set-height" class="block relative trigger">

      <div class="sticky top-0 w-full h-screen bg-neutral-800">
        <div class="relative w-full h-full flex flex-col justify-center items-center">
          <div id="animate" class="absolute z-[2] inset-x-0 max-w-max mx-auto w-[80%] flex items-center justify-center h-[400px] top-[calc(50%-200px)]">
            <video class="!w-[60%] h-auto" id="v0" tabindex="0" autobuffer="autobuffer" preload="preload">
              <source type="video/mp4; codecs=&quot;avc1.42E01E, mp4a.40.2&quot;" src="https://www.apple.com/media/us/mac-pro/2013/16C1b6b5-1d91-4fef-891e-ff2fc1c1bb58/videos/macpro_main_desktop.mp4"></source>
            </video>
          </div>

          <p id="paragraph" class="absolute opacity-0 bottom-[-300px] left-[5%] w-[40%] h-[300px] z-[3] text-white font-semibold text-sm">
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed accumsan condimentum augue, a tincidunt dui finibus vel.
            Curabitur euismod ex convallis, rhoncus mi sed, bibendum metus. Cras sit amet eros dui. Proin consequat neque eget leo
            porta, id rhoncus nibh sagittis. Sed imperdiet sed lorem quis tristique. Donec tristique vitae nunc in tristique.
            Suspendisse aliquam, felis ut condimentum feugiat, augue augue efficitur augue, in commodo arcu erat vel tortor.
            Suspendisse et sodales odio. Sed pulvinar a libero id sodales. Phasellus ac lacus convallis, eleifend arcu quis, blandit
            turpis. Morbi ex justo, congue ut augue in, volutpat commodo sapien. Aenean consectetur aliquam semper. Curabitur at
            dolor sapien. Donec et dignissim tellus. Praesent eu tincidunt lacus. Aenean luctus ultrices risus non vulputate.
          </p>

          <div id="animate2" class="transform translate-y-[100%] h-full bg-neutral-900 w-full" ></div>

        </div>
      </div>      

    </div>

    <script>

      const controller = new ScrollMagic.Controller();
      
      // Cuando el objeto .trigger pasa por el trigger marcador se detona la animaci√≥n tween
      new ScrollMagic.Scene({ triggerElement: ".trigger", duration: 500, offset: 0 })

      .setTween("#animate", 1, { className: "+=extender" })
      .addIndicators({ name: "marcador" })
      .addTo(controller);

      new ScrollMagic.Scene({ triggerElement: ".trigger", duration: 1000, offset: 5000 })

      .setTween("#animate2", 1, { className: "+=up" })
      .addIndicators({ name: "marcador2" })
      .addTo(controller);

      new ScrollMagic.Scene({ triggerElement: ".trigger", duration: 1000, offset: 8000 })

      .setTween("#animate2", 1, { className: "+=upAll" })
      .addIndicators({ name: "marcador3" })
      .addTo(controller);

      new ScrollMagic.Scene({ triggerElement: ".trigger", duration: 2000, offset: 10000 })

      .setTween("#animate2", 1, { className: "+=blue" })
      .addIndicators({ name: "marcador4" })
      .addTo(controller);

      new ScrollMagic.Scene({ triggerElement: ".trigger", duration: 3000, offset: 12000 })

      .setTween("#paragraph", 1, { className: "+=text" })
      .addIndicators({ name: "marcador5" })
      .addTo(controller);

      new ScrollMagic.Scene({ triggerElement: ".trigger", duration: 2000, offset: 14000 })

      .setTween("#paragraph", 1, { className: "+=text2" })
      .addIndicators({ name: "marcador6" })
      .addTo(controller);

      new ScrollMagic.Scene({ triggerElement: ".trigger", duration: 3500, offset: 15000 })

      .setTween("#paragraph", 1, { className: "+=text3" })
      .addIndicators({ name: "marcador7" })
      .addTo(controller);

    </script>

    <script>
      let frameNumber = 0, // start video at frame 0
      // lower numbers = faster playback
      playbackConst = 500, 
      // get page height from video duration
      setHeight = document.getElementById("set-height"), 
      // select video element         
      vid = document.getElementById('v0'); 

      // dynamically set the page height according to video length
      vid.addEventListener('loadedmetadata', function() {
        setHeight.style.height = Math.floor(vid.duration) * playbackConst + "px";
      });

      // Use requestAnimationFrame for smooth playback
      function scrollPlay(){  
        var frameNumber  = window.pageYOffset/playbackConst;
        vid.currentTime  = frameNumber;
        window.requestAnimationFrame(scrollPlay);
      }

      window.requestAnimationFrame(scrollPlay);

    </script>

    <script type="module" src="/main.js"></script>
    
  </body>
</html>

